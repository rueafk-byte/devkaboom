<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kaboom Admin Dashboard</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            font-family: 'Arial', sans-serif;
            min-height: 100vh;
        }
        
        .dashboard-container {
            display: flex;
            min-height: 100vh;
        }
        
        .sidebar {
            width: 280px;
            background: rgba(0, 0, 0, 0.8);
            color: white;
            padding: 20px;
            box-shadow: 2px 0 10px rgba(0, 0, 0, 0.3);
        }
        
        .sidebar-header {
            text-align: center;
            padding-bottom: 20px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.2);
            margin-bottom: 20px;
        }
        
        .sidebar-header h2 {
            font-size: 1.5em;
            margin-bottom: 5px;
        }
        
        .nav-menu {
            list-style: none;
        }
        
        .nav-item {
            margin-bottom: 10px;
        }
        
        .nav-link {
            display: block;
            padding: 12px 15px;
            color: white;
            text-decoration: none;
            border-radius: 8px;
            transition: background 0.3s;
        }
        
        .nav-link:hover, .nav-link.active {
            background: rgba(255, 255, 255, 0.1);
        }
        
        .main-content {
            flex: 1;
            padding: 20px;
            overflow-y: auto;
        }
        
        .page-header {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 20px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }
        
        .page-header h1 {
            color: #495057;
            font-size: 2.2em;
            margin-bottom: 10px;
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .stat-card {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            padding: 25px;
            text-align: center;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            border-left: 5px solid #007bff;
        }
        
        .stat-card.success {
            border-left-color: #28a745;
        }
        
        .stat-card.warning {
            border-left-color: #ffc107;
        }
        
        .stat-card.danger {
            border-left-color: #dc3545;
        }
        
        .stat-icon {
            font-size: 2.5em;
            margin-bottom: 15px;
        }
        
        .stat-value {
            font-size: 2.2em;
            font-weight: bold;
            color: #495057;
            margin-bottom: 5px;
        }
        
        .stat-label {
            color: #6c757d;
            font-size: 1.1em;
        }
        
        .content-section {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 20px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }
        
        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid #f8f9fa;
        }
        
        .section-header h2 {
            color: #495057;
            font-size: 1.5em;
        }
        
        .refresh-btn {
            background: linear-gradient(135deg, #007bff 0%, #0056b3 100%);
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
        }
        
        .players-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }
        
        .players-table th,
        .players-table td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #e9ecef;
        }
        
        .players-table th {
            background: #f8f9fa;
            font-weight: bold;
            color: #495057;
        }
        
        .players-table tr:hover {
            background: #f8f9fa;
        }
        
        .token-amount {
            font-weight: bold;
            color: #ffc107;
        }
        
        .action-btn {
            background: linear-gradient(135deg, #dc3545 0%, #c82333 100%);
            color: white;
            border: none;
            padding: 6px 12px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 12px;
            margin-right: 5px;
        }
        
        .action-btn.warning {
            background: linear-gradient(135deg, #ffc107 0%, #e0a800 100%);
            color: #212529;
        }
        
        .action-btn.success {
            background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
        }
        
        .search-box {
            width: 100%;
            padding: 10px;
            border: 2px solid #ced4da;
            border-radius: 8px;
            font-size: 16px;
            margin-bottom: 20px;
        }
        
        .search-box:focus {
            outline: none;
            border-color: #007bff;
        }
        
        .no-data {
            text-align: center;
            padding: 50px;
            color: #6c757d;
        }
        
        .loading {
            text-align: center;
            padding: 50px;
            color: #6c757d;
        }
        
        .loading::after {
            content: '';
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid #f3f3f3;
            border-top: 3px solid #007bff;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-left: 10px;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .chart-container {
            height: 300px;
            margin-top: 20px;
        }
        
        @media (max-width: 768px) {
            .dashboard-container {
                flex-direction: column;
            }
            
            .sidebar {
                width: 100%;
                order: 2;
            }
            
            .main-content {
                order: 1;
            }
            
            .stats-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="dashboard-container">
        <div class="sidebar">
            <div class="sidebar-header">
                <h2>üéÆ Kaboom Admin</h2>
                <p>Dashboard</p>
            </div>
            
            <ul class="nav-menu">
                <li class="nav-item">
                    <a href="#overview" class="nav-link active" onclick="showPage('overview')">
                        üìä Overview
                    </a>
                </li>
                <li class="nav-item">
                    <a href="#players" class="nav-link" onclick="showPage('players')">
                        üë• All Players
                    </a>
                </li>
                <li class="nav-item">
                    <a href="#analytics" class="nav-link" onclick="showPage('analytics')">
                        üìà Analytics
                    </a>
                </li>
                <li class="nav-item">
                    <a href="#search" class="nav-link" onclick="showPage('search')">
                        üîç Search Player
                    </a>
                </li>
            </ul>
        </div>
        
        <div class="main-content">
            <!-- Overview Page -->
            <div id="overview" class="page">
                <div class="page-header">
                    <h1>üìä Dashboard Overview</h1>
                    <p>Real-time statistics and game performance metrics</p>
                </div>
                
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-icon">üë•</div>
                        <div class="stat-value" id="totalPlayers">0</div>
                        <div class="stat-label">Total Players</div>
                    </div>
                    <div class="stat-card success">
                        <div class="stat-icon">üí∞</div>
                        <div class="stat-value" id="totalTokens">0</div>
                        <div class="stat-label">Total $BOOM Tokens</div>
                    </div>
                    <div class="stat-card warning">
                        <div class="stat-icon">üéÆ</div>
                        <div class="stat-value" id="totalScore">0</div>
                        <div class="stat-label">Total Score</div>
                    </div>
                    <div class="stat-card danger">
                        <div class="stat-icon">‚≠ê</div>
                        <div class="stat-value" id="avgLevel">0</div>
                        <div class="stat-label">Average Level</div>
                    </div>
                </div>
                
                <div class="content-section">
                    <div class="section-header">
                        <h2>üéØ Recent Activity</h2>
                        <button class="refresh-btn" onclick="loadOverview()">üîÑ Refresh</button>
                    </div>
                    <div id="recentActivity">
                        <div class="loading">Loading recent activity...</div>
                    </div>
                </div>
            </div>
            
            <!-- Players Page -->
            <div id="players" class="page" style="display: none;">
                <div class="page-header">
                    <h1>üë• All Players</h1>
                    <p>Manage and view all registered players</p>
                </div>
                
                <div class="content-section">
                    <div class="section-header">
                        <h2>Player List</h2>
                        <button class="refresh-btn" onclick="loadPlayers()">üîÑ Refresh</button>
                    </div>
                    
                    <input type="text" class="search-box" id="playerSearch" placeholder="Search players by wallet address or username...">
                    
                    <div id="playersTable">
                        <div class="loading">Loading players...</div>
                    </div>
                </div>
            </div>
            
            <!-- Analytics Page -->
            <div id="analytics" class="page" style="display: none;">
                <div class="page-header">
                    <h1>üìà Analytics</h1>
                    <p>Game performance and player behavior insights</p>
                </div>
                
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-icon">üìä</div>
                        <div class="stat-value" id="avgScore">0</div>
                        <div class="stat-label">Average Score</div>
                    </div>
                    <div class="stat-card success">
                        <div class="stat-icon">üèÜ</div>
                        <div class="stat-value" id="topPlayer">-</div>
                        <div class="stat-label">Top Player</div>
                    </div>
                    <div class="stat-card warning">
                        <div class="stat-icon">üéØ</div>
                        <div class="stat-value" id="avgTokens">0</div>
                        <div class="stat-label">Avg Tokens/Player</div>
                    </div>
                    <div class="stat-card danger">
                        <div class="stat-icon">‚è∞</div>
                        <div class="stat-value" id="lastActivity">-</div>
                        <div class="stat-label">Last Activity</div>
                    </div>
                </div>
                
                <div class="content-section">
                    <div class="section-header">
                        <h2>üìä Token Distribution</h2>
                    </div>
                    <div id="tokenChart" class="chart-container">
                        <div class="loading">Loading chart...</div>
                    </div>
                </div>
            </div>
            
            <!-- Search Page -->
            <div id="search" class="page" style="display: none;">
                <div class="page-header">
                    <h1>üîç Search Player</h1>
                    <p>Find specific player by wallet address</p>
                </div>
                
                <div class="content-section">
                    <div class="section-header">
                        <h2>Player Search</h2>
                    </div>
                    
                    <div style="display: flex; gap: 15px; margin-bottom: 20px;">
                        <input type="text" class="search-box" id="searchWallet" placeholder="Enter wallet address..." style="flex: 1;">
                        <button class="refresh-btn" onclick="searchPlayer()">üîç Search</button>
                    </div>
                    
                    <div id="searchResults">
                        <div class="no-data">Enter a wallet address to search for a player</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        class AdminDashboard {
            constructor() {
                this.currentPage = 'overview';
                this.players = [];
                this.initializeEventListeners();
                this.loadOverview();
            }
            
            initializeEventListeners() {
                // Search functionality
                document.getElementById('playerSearch').addEventListener('input', (e) => {
                    this.filterPlayers(e.target.value);
                });
                
                // Search player functionality
                document.getElementById('searchWallet').addEventListener('keypress', (e) => {
                    if (e.key === 'Enter') {
                        this.searchPlayer();
                    }
                });
            }
            
            showPage(pageName) {
                // Hide all pages
                document.querySelectorAll('.page').forEach(page => {
                    page.style.display = 'none';
                });
                
                // Show selected page
                document.getElementById(pageName).style.display = 'block';
                
                // Update navigation
                document.querySelectorAll('.nav-link').forEach(link => {
                    link.classList.remove('active');
                });
                event.target.classList.add('active');
                
                this.currentPage = pageName;
                
                // Load page-specific data
                switch(pageName) {
                    case 'overview':
                        this.loadOverview();
                        break;
                    case 'players':
                        this.loadPlayers();
                        break;
                    case 'analytics':
                        this.loadAnalytics();
                        break;
                }
            }
            
            loadOverview() {
                this.loadAllPlayers().then(() => {
                    this.updateOverviewStats();
                    this.updateRecentActivity();
                });
            }
            
            loadPlayers() {
                this.loadAllPlayers().then(() => {
                    this.displayPlayersTable();
                });
            }
            
            loadAnalytics() {
                this.loadAllPlayers().then(() => {
                    this.updateAnalyticsStats();
                    this.displayTokenChart();
                });
            }
            
            async loadAllPlayers() {
                this.players = [];
                
                // Scan localStorage for all player data
                for (let i = 0; i < localStorage.length; i++) {
                    const key = localStorage.key(i);
                    
                    if (key.startsWith('kaboom_')) {
                        const walletAddress = key.replace('kaboom_', '');
                        const profileData = localStorage.getItem(key);
                        
                        if (profileData) {
                            try {
                                const profile = JSON.parse(profileData);
                                this.players.push({
                                    walletAddress: walletAddress,
                                    ...profile
                                });
                            } catch (error) {
                                console.error('Error parsing profile data:', error);
                            }
                        }
                    }
                    
                    if (key.startsWith('playerProgress_')) {
                        const walletAddress = key.replace('playerProgress_', '');
                        const progressData = localStorage.getItem(key);
                        
                        if (progressData) {
                            try {
                                const progress = JSON.parse(progressData);
                                // Check if we already have this player
                                const existingPlayer = this.players.find(p => p.walletAddress === walletAddress);
                                
                                if (!existingPlayer) {
                                    this.players.push({
                                        walletAddress: walletAddress,
                                        username: `Player_${walletAddress.slice(0, 6)}`,
                                        level: progress.level || 1,
                                        totalScore: progress.score || 0,
                                        boomTokens: Math.floor((progress.score || 0) * 0.10),
                                        lives: progress.lives || 3,
                                        lastUpdated: progress.timestamp || Date.now()
                                    });
                                }
                            } catch (error) {
                                console.error('Error parsing progress data:', error);
                            }
                        }
                    }
                }
                
                // Sort players by total score (descending)
                this.players.sort((a, b) => (b.totalScore || 0) - (a.totalScore || 0));
            }
            
            updateOverviewStats() {
                const totalPlayers = this.players.length;
                const totalTokens = this.players.reduce((sum, player) => sum + (player.boomTokens || 0), 0);
                const totalScore = this.players.reduce((sum, player) => sum + (player.totalScore || 0), 0);
                const avgLevel = totalPlayers > 0 ? Math.round(this.players.reduce((sum, player) => sum + (player.level || 1), 0) / totalPlayers) : 0;
                
                document.getElementById('totalPlayers').textContent = totalPlayers.toLocaleString();
                document.getElementById('totalTokens').textContent = totalTokens.toLocaleString();
                document.getElementById('totalScore').textContent = totalScore.toLocaleString();
                document.getElementById('avgLevel').textContent = avgLevel;
            }
            
            updateRecentActivity() {
                const recentPlayers = this.players
                    .sort((a, b) => (b.lastUpdated || 0) - (a.lastUpdated || 0))
                    .slice(0, 5);
                
                const activityHtml = recentPlayers.length > 0 ? 
                    recentPlayers.map(player => `
                        <div style="padding: 15px; border-bottom: 1px solid #e9ecef; display: flex; justify-content: space-between; align-items: center;">
                            <div>
                                <strong>${player.username || `Player_${player.walletAddress.slice(0, 6)}`}</strong>
                                <div style="color: #6c757d; font-size: 0.9em;">
                                    ${player.walletAddress.slice(0, 8)}...${player.walletAddress.slice(-8)}
                                </div>
                            </div>
                            <div style="text-align: right;">
                                <div style="font-weight: bold; color: #ffc107;">${(player.boomTokens || 0).toLocaleString()} $BOOM</div>
                                <div style="color: #6c757d; font-size: 0.9em;">
                                    ${new Date(player.lastUpdated || Date.now()).toLocaleDateString()}
                                </div>
                            </div>
                        </div>
                    `).join('') :
                    '<div class="no-data">No recent activity</div>';
                
                document.getElementById('recentActivity').innerHTML = activityHtml;
            }
            
            displayPlayersTable() {
                if (this.players.length === 0) {
                    document.getElementById('playersTable').innerHTML = '<div class="no-data">No players found</div>';
                    return;
                }
                
                const tableHtml = `
                    <table class="players-table">
                        <thead>
                            <tr>
                                <th>Player</th>
                                <th>Wallet Address</th>
                                <th>Level</th>
                                <th>Score</th>
                                <th>$BOOM Tokens</th>
                                <th>Last Updated</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody>
                            ${this.players.map(player => `
                                <tr>
                                    <td><strong>${player.username || `Player_${player.walletAddress.slice(0, 6)}`}</strong></td>
                                    <td style="font-family: monospace; font-size: 0.9em;">
                                        ${player.walletAddress.slice(0, 8)}...${player.walletAddress.slice(-8)}
                                    </td>
                                    <td>${player.level || 1}</td>
                                    <td>${(player.totalScore || 0).toLocaleString()}</td>
                                    <td class="token-amount">${(player.boomTokens || 0).toLocaleString()}</td>
                                    <td>${new Date(player.lastUpdated || Date.now()).toLocaleDateString()}</td>
                                    <td>
                                        <button class="action-btn warning" onclick="dashboard.resetPlayer('${player.walletAddress}')">Reset</button>
                                        <button class="action-btn" onclick="dashboard.deletePlayer('${player.walletAddress}')">Delete</button>
                                        <button class="action-btn success" onclick="dashboard.exportPlayer('${player.walletAddress}')">Export</button>
                                    </td>
                                </tr>
                            `).join('')}
                        </tbody>
                    </table>
                `;
                
                document.getElementById('playersTable').innerHTML = tableHtml;
            }
            
            filterPlayers(searchTerm) {
                const filteredPlayers = this.players.filter(player => 
                    player.walletAddress.toLowerCase().includes(searchTerm.toLowerCase()) ||
                    (player.username && player.username.toLowerCase().includes(searchTerm.toLowerCase()))
                );
                
                this.displayFilteredPlayers(filteredPlayers);
            }
            
            displayFilteredPlayers(players) {
                if (players.length === 0) {
                    document.getElementById('playersTable').innerHTML = '<div class="no-data">No players found matching your search</div>';
                    return;
                }
                
                const tableHtml = `
                    <table class="players-table">
                        <thead>
                            <tr>
                                <th>Player</th>
                                <th>Wallet Address</th>
                                <th>Level</th>
                                <th>Score</th>
                                <th>$BOOM Tokens</th>
                                <th>Last Updated</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody>
                            ${players.map(player => `
                                <tr>
                                    <td><strong>${player.username || `Player_${player.walletAddress.slice(0, 6)}`}</strong></td>
                                    <td style="font-family: monospace; font-size: 0.9em;">
                                        ${player.walletAddress.slice(0, 8)}...${player.walletAddress.slice(-8)}
                                    </td>
                                    <td>${player.level || 1}</td>
                                    <td>${(player.totalScore || 0).toLocaleString()}</td>
                                    <td class="token-amount">${(player.boomTokens || 0).toLocaleString()}</td>
                                    <td>${new Date(player.lastUpdated || Date.now()).toLocaleDateString()}</td>
                                    <td>
                                        <button class="action-btn warning" onclick="dashboard.resetPlayer('${player.walletAddress}')">Reset</button>
                                        <button class="action-btn" onclick="dashboard.deletePlayer('${player.walletAddress}')">Delete</button>
                                        <button class="action-btn success" onclick="dashboard.exportPlayer('${player.walletAddress}')">Export</button>
                                    </td>
                                </tr>
                            `).join('')}
                        </tbody>
                    </table>
                `;
                
                document.getElementById('playersTable').innerHTML = tableHtml;
            }
            
            updateAnalyticsStats() {
                if (this.players.length === 0) {
                    document.getElementById('avgScore').textContent = '0';
                    document.getElementById('topPlayer').textContent = '-';
                    document.getElementById('avgTokens').textContent = '0';
                    document.getElementById('lastActivity').textContent = '-';
                    return;
                }
                
                const avgScore = Math.round(this.players.reduce((sum, player) => sum + (player.totalScore || 0), 0) / this.players.length);
                const topPlayer = this.players[0] ? (this.players[0].username || `Player_${this.players[0].walletAddress.slice(0, 6)}`) : '-';
                const avgTokens = Math.round(this.players.reduce((sum, player) => sum + (player.boomTokens || 0), 0) / this.players.length);
                const lastActivity = this.players.length > 0 ? new Date(Math.max(...this.players.map(p => p.lastUpdated || 0))).toLocaleDateString() : '-';
                
                document.getElementById('avgScore').textContent = avgScore.toLocaleString();
                document.getElementById('topPlayer').textContent = topPlayer;
                document.getElementById('avgTokens').textContent = avgTokens.toLocaleString();
                document.getElementById('lastActivity').textContent = lastActivity;
            }
            
            displayTokenChart() {
                // Simple text-based chart for token distribution
                const tokenRanges = [
                    { min: 0, max: 100, label: '0-100', count: 0 },
                    { min: 101, max: 500, label: '101-500', count: 0 },
                    { min: 501, max: 1000, label: '501-1000', count: 0 },
                    { min: 1001, max: 5000, label: '1001-5000', count: 0 },
                    { min: 5001, max: Infinity, label: '5000+', count: 0 }
                ];
                
                this.players.forEach(player => {
                    const tokens = player.boomTokens || 0;
                    const range = tokenRanges.find(r => tokens >= r.min && tokens <= r.max);
                    if (range) range.count++;
                });
                
                const chartHtml = `
                    <div style="margin-top: 20px;">
                        <h3>Token Distribution</h3>
                        ${tokenRanges.map(range => `
                            <div style="margin: 10px 0; display: flex; align-items: center;">
                                <div style="width: 100px; font-weight: bold;">${range.label}:</div>
                                <div style="flex: 1; background: #e9ecef; height: 20px; border-radius: 10px; margin: 0 10px; overflow: hidden;">
                                    <div style="background: linear-gradient(135deg, #ffc107 0%, #ff8c00 100%); height: 100%; width: ${this.players.length > 0 ? (range.count / this.players.length) * 100 : 0}%;"></div>
                                </div>
                                <div style="width: 50px; text-align: right;">${range.count}</div>
                            </div>
                        `).join('')}
                    </div>
                `;
                
                document.getElementById('tokenChart').innerHTML = chartHtml;
            }
            
            searchPlayer() {
                const walletAddress = document.getElementById('searchWallet').value.trim();
                
                if (!walletAddress) {
                    document.getElementById('searchResults').innerHTML = '<div class="no-data">Please enter a wallet address</div>';
                    return;
                }
                
                const player = this.players.find(p => p.walletAddress === walletAddress);
                
                if (player) {
                    const resultHtml = `
                        <div style="background: #f8f9fa; padding: 20px; border-radius: 10px; border-left: 4px solid #28a745;">
                            <h3>${player.username || `Player_${player.walletAddress.slice(0, 6)}`}</h3>
                            <p><strong>Wallet:</strong> ${player.walletAddress}</p>
                            <p><strong>Level:</strong> ${player.level || 1}</p>
                            <p><strong>Score:</strong> ${(player.totalScore || 0).toLocaleString()}</p>
                            <p><strong>$BOOM Tokens:</strong> <span style="color: #ffc107; font-weight: bold;">${(player.boomTokens || 0).toLocaleString()}</span></p>
                            <p><strong>Last Updated:</strong> ${new Date(player.lastUpdated || Date.now()).toLocaleString()}</p>
                        </div>
                    `;
                    document.getElementById('searchResults').innerHTML = resultHtml;
                } else {
                    document.getElementById('searchResults').innerHTML = '<div class="no-data">Player not found</div>';
                }
            }
            
            resetPlayer(walletAddress) {
                if (confirm(`Reset progress for ${walletAddress}?`)) {
                    localStorage.removeItem(`kaboom_${walletAddress}`);
                    localStorage.removeItem(`playerProgress_${walletAddress}`);
                    this.loadPlayers();
                }
            }
            
            deletePlayer(walletAddress) {
                if (confirm(`Delete player ${walletAddress}?`)) {
                    localStorage.removeItem(`kaboom_${walletAddress}`);
                    localStorage.removeItem(`playerProgress_${walletAddress}`);
                    this.loadPlayers();
                }
            }
            
            exportPlayer(walletAddress) {
                const player = this.players.find(p => p.walletAddress === walletAddress);
                if (player) {
                    const dataStr = JSON.stringify(player, null, 2);
                    const dataBlob = new Blob([dataStr], {type: 'application/json'});
                    const url = URL.createObjectURL(dataBlob);
                    
                    const link = document.createElement('a');
                    link.href = url;
                    link.download = `player_${walletAddress.slice(0, 8)}_${Date.now()}.json`;
                    link.click();
                    
                    URL.revokeObjectURL(url);
                }
            }
        }
        
        // Global functions for onclick handlers
        function showPage(pageName) {
            dashboard.showPage(pageName);
        }
        
        function searchPlayer() {
            dashboard.searchPlayer();
        }
        
        // Initialize dashboard
        const dashboard = new AdminDashboard();
    </script>
</body>
</html>
